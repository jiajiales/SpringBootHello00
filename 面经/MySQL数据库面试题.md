*MySQL 经典面试题* 
-------------------

MySQL 面试
----------

### 1 存储过程

**什么是存储过程**  
存储过程是一些编译好的SQL语句  
因为系统在调用SQL的时候比较浪费时间，所以之前先将一些基本的额SQL语句代码进行编译（对单表或多表的增删改查），然后再给代码取一个名字，在需要这个功能时去调用它就可以了。  
**优缺点**

-   存储工程是编译后的代码 **效率高**

-   存储过程代替SQL语句，降低网络通信

-   在一定的程度确保数据安全

### 2 索引

**索引是什么**  
索引是对数据库中一或多个列值的排序，帮助数据库高效获取数据的数据结构  
假如我们用类比的方法，数据库中的索引就相当于书籍中的目录一样，当我们想找到书中的摸个知识点，我们可以直接去目录中找而不是在书中每页的找，但是这也抛出了索引的一个缺点，在对数据库修改的时候要修改索引到导致时间变多。  
**几个基本的索引类型** *普通索引 唯一索引 主键索引 全文索引*  
**索引优点**

-   加快检索速度

-   唯一索引确保每行数据的唯一性

-   在使用索引的过程可以优化隐藏器，提高系统性能

**索引缺点**

-   插入删除 修改 维护速度下降

-   占用物理和数据空间

### 3 事务

**事务的作用**  
事务（Transaction）是并发控制的基本单位。事务就是一系列的操作，这些操作要么都执行，要么都不执行。  
**事务具有以下4个基本特征**

-   Atomic（原子性） 事务中的一系列的操作要么都完成，要么全部失败

-   Consistency（一致性）
    一个成功的事务应该讲数据写入的到数据库，否则就要回滚到最初的状态

-   Isolation（隔离性） 并发访问和修改的duli

-   Durability（持久性） 事务结束应该讲事务的处理结构存储起来  
    **事务的语句**

-   开始事物：BEGIN TRANSACTION

-   提交事物：COMMIT TRANSACTION

-   回滚事务：ROLLBACK TRANSACTION

### 4 数据库中的乐观锁和悲观锁

**根据不同类型可以对数据设置不同的锁权限**  
\*\* 乐观 悲观 锁 主要是作用在并发访问控制\*\*

-   **悲观锁** 假定会发生并发冲突，屏蔽任何违反数据完整的操作

-   **乐观锁** 假定不会发生冲突，只有在提交操作时检查是否违反数据的完整性

### 5 **drop， delete truncate**的区别

三者都是**删除**的意思，但是三者个有些区别

-   delete和truncate只删除表的数据不删除表的结构

-   速度 drop \> truncate \> delete

-   想删除部分数据时， delete 删除时要带上where语句

-   保留表而想删除所有的数据时用**truncate**

**（**[SQL truncate 、delete与drop区别](http://www.cnblogs.com/8765h/archive/2011/11/25/2374167.html) 
======================================================================================================

相同点：

1.truncate和不带where子句的delete、以及drop都会删除表内的数据。

 

2.drop、truncate都是DDL语句(数据定义语言),执行后会自动提交。

 

不同点：

1. truncate 和 delete 只删除数据不删除表的结构(定义)  
drop
语句将删除表的结构被依赖的约束(constrain)、触发器(trigger)、索引(index)；依赖于该表的存储过程/函数将保留,但是变为
invalid 状态。

 

2. delete 语句是数据库操作语言(dml)，这个操作会放到 rollback segement
中，事务提交之后才生效；如果有相应的 trigger，执行的时候将被触发。  
truncate、drop 是数据库定义语言(ddl)，操作立即生效，原数据不放到 rollback
segment 中，不能回滚，操作不触发 trigger。

 

3.delete 语句不影响表所占用的 extent，高水线(high watermark)保持原位置不动  
drop 语句将表所占用的空间全部释放。  
truncate 语句缺省情况下见空间释放到 minextents个 extent，除非使用reuse
storage；truncate 会将高水线复位(回到最开始)。

 

4.速度，一般来说: drop\> truncate \> delete

 

5.安全性：小心使用 drop 和 truncate，尤其没有备份的时候.否则哭都来不及  
使用上,想删除部分数据行用 delete，注意带上where子句. 回滚段要足够大.  
想删除表,当然用 drop  
想保留表而将所有数据删除，如果和事务无关，用truncate即可。如果和事务有关,或者想触发trigger,还是用delete。  
如果是整理表内部的碎片，可以用truncate跟上reuse stroage，再重新导入/插入数据。

6.delete是DML语句,不会自动提交。drop/truncate都是DDL语句,执行后会自动提交。

 

7、TRUNCATE   TABLE   在功能上与不带   WHERE   子句的   DELETE  
语句相同：二者均删除表中的全部行。但   TRUNCATE   TABLE   比   DELETE  
速度快，且使用的系统和事务日志资源少。DELETE  
语句每次删除一行，并在事务日志中为所删除的每行记录一项。TRUNCATE   TABLE  
通过释放存储表数据所用的数据页来删除数据，并且只在事务日志中记录页的释放。 

 

8、TRUNCATE   TABLE  
删除表中的所有行，但表结构及其列、约束、索引等保持不变。新行标识所用的计数值重置为该列的种子。如果想保留标识计数值，请改用  
DELETE。如果要删除表定义及其数据，请使用   DROP   TABLE   语句。    
     
9、对于由   FOREIGN   KEY   约束引用的表，不能使用   TRUNCATE  
TABLE，而应使用不带   WHERE   子句的   DELETE   语句。由于   TRUNCATE   TABLE  
不记录在日志中，所以它不能激活触发器。      
 

10、TRUNCATE   TABLE   不能用于参与了索引视图的表

-   **）**

### 6 超键 候选键 主键 外键 区别

**超键**在关系中能唯一标识元组的属性集称为关系模式的超键
，一个或多个属性组合在一起作为超键。  
**候选键** 最下超键，没有冗余元素的超键  
**主键** 数据库中表中唯一和完整标识的数据列或属性集合。  
**外键** 在一个表中存在另外一个表的主键叫做外键

### 7视图

**定义** 视图是一种虚拟表，可以对视图进行增删查改
。可以将一个表多个表组合成一个视图。对视图的修改不影响基本表。

### 8 数据库三大范式介绍

-   1NF 字段是最小单元，不可再分

-   2NF 满足1NF 表中字段必须完全依赖全部主键而并非部分主键

>   3NF 满足2NF，非主键外的所有字段必须互不依赖

>   4.数据库三范式

>   第一范式 字段具有原子性，不可再分

>   第二范式 表中的每列都和主键相关

>   第三范式 每列都和主键列直接相关，而不是间接相关
